@page "/ReservationDetailsAdmin/{id:int}"
@inject AuthenticationStateProvider _AuthenticationStateProvider
@inject HttpClient Http
@using HotelManagment.Shared
@using HotelManagment.Server.Models;

<div class="paper-card">
    <div class="card-header">
        Reservation Details
    </div>
    <div class="card-body">
        <div class="form-group">
            <label>Room Number:</label>
            <span>@reservation.RoomID</span>
        </div>
        <div class="form-group">
            <label>First Name:</label>
            <span>@reservation.FirstName</span>
        </div>
        <div class="form-group">
            <label>Last Name:</label>
            <span>@reservation.LastName</span>
        </div>
        <div class="form-group">
            <label>Email:</label>
            <span>@reservation.Email</span>
        </div>
        <div class="form-group">
            <label>Address:</label>
            <span>@reservation.Adress</span>
        </div>
        <div class="form-group">
            <label>How Many Persons:</label>
            <span>@reservation.HowManyPerosn</span>
        </div>
        <div class="form-group">
            <label>Check-in Date:</label>
            <span>@reservation.CheckInDate</span>
        </div>
        <div class="form-group">
            <label>Check-out Date:</label>
            <span>@reservation.CheckOutDate</span>
        </div>
        <div class="form-group">
            <label>Is Paid:</label>
            <span>@(reservation.IsPaid ? "Yes" : "No")</span>
        </div>
        <div class="form-group">
            <label>Is Reserved:</label>
            <span>@(reservation.IsReserved ? "Yes" : "No")</span>
        </div>
        <div class="form-group">
            <label>Amount:</label>
            <span>@reservation.Amount</span>
        </div>
        <div class="form-group">
            <label>Phone Number:</label>
            <span>@reservation.PhoneNumber</span>
        </div>
        <div class="form-group">
            <label>Staff:</label>
            <span>@reservation.Staff</span>
        </div>
        <div class="form-group">
            <label>Digital Signature:</label>
            <span>@reservation.DigitalSignuture</span>
        </div>
        <div class="form-group">
            <label>Gender:</label>
            <span>@reservation.gender</span>
        </div>
    </div>
</div>

<HotelManagment.Client.Component.UsersComponent.ReturnButton ButtonText="Return" Destination="/AllReservation"></HotelManagment.Client.Component.UsersComponent.ReturnButton>
@code {
    [Parameter]
    public int id { get; set; }
    public string  user2 { get; set; }
    public Reservation reservation = new Reservation();

    protected override async Task OnInitializedAsync()
    {
        // Check if the user is logged in and fetch their information
        var authState = await _AuthenticationStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;
        if (user.Identity?.IsAuthenticated ?? false)
        {
            // User is authenticated, you can access user ID
            user2 = user.FindFirst(c => c.Type == "sub")?.Value;

            reservation = await Http.GetFromJsonAsync<Reservation>($"Administration/GetReservationByIdAdmin/{id}");

        }
    }
}
